{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2026-01-01T18:49:00.902704Z", "invocation_id": "4f9be73a-d1ba-47fa-9ec4-f49828b47799", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-01T18:49:00.563003Z", "completed_at": "2026-01-01T18:49:00.571531Z"}, {"name": "execute", "started_at": "2026-01-01T18:49:00.571917Z", "completed_at": "2026-01-01T18:49:00.657262Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09587717056274414, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbt_flight_transform.stg_lnd_flights", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from 's3://flights-data-lake/bronze/insert_date=2025-01-01/*.parquet'\n)\n\nselect * from source", "relation_name": "\"analytics\".\"main\".\"stg_lnd_flights\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-01T18:49:00.661881Z", "completed_at": "2026-01-01T18:49:00.664392Z"}, {"name": "execute", "started_at": "2026-01-01T18:49:00.664717Z", "completed_at": "2026-01-01T18:49:00.696808Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.036081790924072266, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbt_flight_transform.int_flights_kpis", "compiled": true, "compiled_code": "with stg_lnd_flights as (\n    select * from \"analytics\".\"main\".\"stg_lnd_flights\"\n)\n\nselect\n    *,\n    case\n        when dep_delay_min is null then 'unknown'\n        when dep_delay_min > 30 then 'high_delay'\n        when dep_delay_min > 15 then 'medium_delay'\n        when dep_delay_min <= -15 then 'early'\n        else 'ontime'\n    end as delay_category,\n    dep_delay_min as avg_delay\nfrom stg_lnd_flights", "relation_name": "\"analytics\".\"main\".\"int_flights_kpis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-01T18:49:00.700431Z", "completed_at": "2026-01-01T18:49:00.705792Z"}, {"name": "execute", "started_at": "2026-01-01T18:49:00.706129Z", "completed_at": "2026-01-01T18:49:00.854274Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15492534637451172, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbt_flight_transform.fct_flights", "compiled": true, "compiled_code": "\n\nwith int_flights_kpis as (\n    select * from \"analytics\".\"main\".\"int_flights_kpis\"\n)\n\nselect\n    md5(cast(coalesce(cast(flight_iata_full as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(flight_date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as flight_key,\n    flight_date,\n    dep_iata,\n    arr_iata,\n    airline_iata,\n    delay_category,\n    dep_delay_min,\n    avg(avg_delay) over (\n        partition by dep_iata, arr_iata\n        order by flight_date\n        rows between 6 preceding and current row\n    ) as avg_delay_7d\nfrom int_flights_kpis\n\n    where flight_date::DATE >= (select max(flight_date)::DATE - 7 from \"analytics\".\"main\".\"fct_flights\")\n", "relation_name": "\"analytics\".\"main\".\"fct_flights\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-01T18:49:00.857855Z", "completed_at": "2026-01-01T18:49:00.860870Z"}, {"name": "execute", "started_at": "2026-01-01T18:49:00.861207Z", "completed_at": "2026-01-01T18:49:00.895262Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03867387771606445, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbt_flight_transform.fct_route_daily", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        flight_date,\n        dep_iata,\n        arr_iata,\n        airline_iata,\n        dep_delay_min,\n        delay_category\n    from \"analytics\".\"main\".\"fct_flights\"\n),\n\nagg as (\n    select\n        flight_date,\n        dep_iata,\n        arr_iata,\n        dep_iata || '-' || arr_iata as route,\n        airline_iata,\n        count(*) as total_flights,\n        avg(dep_delay_min) as avg_dep_delay_min,\n        sum(case when delay_category in ('medium_delay','high_delay') then 1 else 0 end) * 100.0 / count(*) as delayed_pct\n    from base\n    group by 1,2,3,4,5\n)\n\nselect\n    flight_date,\n    route,\n    dep_iata,\n    arr_iata,\n    airline_iata,\n    total_flights,\n    round(avg_dep_delay_min, 2) as avg_dep_delay_min,\n    round(delayed_pct, 2) as delayed_pct\nfrom agg", "relation_name": "\"analytics\".\"main\".\"fct_route_daily\""}], "elapsed_time": 0.4780609607696533, "args": {"empty": false, "log_level_file": "debug", "show_resource_report": false, "require_explicit_package_overrides_for_builtin_materializations": true, "select": [], "quiet": false, "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "defer": false, "strict_mode": false, "use_colors": true, "log_path": "/opt/airflow/dbt_transform/logs", "macro_debugging": false, "write_json": true, "static_parser": true, "partial_parse_file_diff": true, "introspect": true, "source_freshness_run_project_hooks": false, "print": true, "cache_selected_only": false, "send_anonymous_usage_stats": true, "exclude": [], "vars": {"execution_date": "2025-01-01"}, "printer_width": 80, "require_resource_names_without_spaces": false, "log_format_file": "debug", "version_check": true, "use_colors_file": true, "log_level": "info", "indirect_selection": "eager", "log_format": "default", "project_dir": "/opt/airflow/dbt_transform", "partial_parse": true, "invocation_command": "dbt run --profiles-dir . --vars execution_date: 2025-01-01", "favor_state": false, "profiles_dir": ".", "populate_cache": true, "which": "run", "warn_error_options": {"include": [], "exclude": []}}}