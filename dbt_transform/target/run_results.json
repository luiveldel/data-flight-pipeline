{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2026-01-04T20:04:09.027399Z", "invocation_id": "04381031-6e9b-4e58-b719-5a67fcf8a114", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-04T20:04:08.192935Z", "completed_at": "2026-01-04T20:04:08.204323Z"}, {"name": "execute", "started_at": "2026-01-04T20:04:08.204768Z", "completed_at": "2026-01-04T20:04:08.326558Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14653491973876953, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbt_flight_transform.stg_lnd_flights", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from 's3://flights-data-lake/bronze/insert_date=2025-01-01/*.parquet'\n)\n\nselect\n    '2025-01-01'::date as insert_date_ci,\n    flight_date::date as flight_date,\n    flight_status::varchar(20) as flight_status,\n    dep_airport::varchar(100) as dep_airport,\n    dep_iata::varchar(3) as dep_iata,\n    dep_scheduled::timestamp as dep_scheduled,\n    dep_actual as dep_actual,\n    arr_airport::varchar(100) as arr_airport,\n    arr_iata::varchar(3) as arr_iata,\n    arr_scheduled::timestamp as arr_scheduled,\n    arr_actual as arr_actual,\n    airline_iata::varchar(3) as airline_iata,\n    flight_number::varchar(10) as flight_number,\n    airline_iata || flight_number as flight_iata_full,\n    dep_delay_min::int as dep_delay_min,\n    arr_delay_min::int as arr_delay_min,\n    dep_scheduled_ts::timestamp as dep_scheduled_ts,\n    arr_scheduled_ts::timestamp as arr_scheduled_ts,\n    ingestion_date::date as ingestion_date\nfrom source\nwhere flight_date::date is not null", "relation_name": "\"analytics\".\"main\".\"stg_lnd_flights\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-04T20:04:08.346119Z", "completed_at": "2026-01-04T20:04:08.350941Z"}, {"name": "execute", "started_at": "2026-01-04T20:04:08.351799Z", "completed_at": "2026-01-04T20:04:08.429215Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09668231010437012, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.dbt_flight_transform.test_stg_flights_bronze_not_null_flight_date", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"analytics\".\"main\".\"stg_lnd_flights\"\nwhere flight_date is null", "relation_name": "\"analytics\".\"main_metadata\".\"test_stg_flights_bronze_not_null_flight_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-04T20:04:08.445859Z", "completed_at": "2026-01-04T20:04:08.449024Z"}, {"name": "execute", "started_at": "2026-01-04T20:04:08.449474Z", "completed_at": "2026-01-04T20:04:08.502320Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06829214096069336, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbt_flight_transform.int_flights_kpis", "compiled": true, "compiled_code": "with stg_lnd_flights as (\n    select * from \"analytics\".\"main\".\"stg_lnd_flights\"\n)\n\nselect\n    *,\n    case\n        when dep_delay_min is null then 'unknown'\n        when dep_delay_min > 30 then 'high_delay'\n        when dep_delay_min > 15 then 'medium_delay'\n        when dep_delay_min <= -15 then 'early'\n        else 'ontime'\n    end as delay_category,\n    dep_delay_min as avg_delay\nfrom stg_lnd_flights", "relation_name": "\"analytics\".\"main\".\"int_flights_kpis\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-04T20:04:08.520786Z", "completed_at": "2026-01-04T20:04:08.532085Z"}, {"name": "execute", "started_at": "2026-01-04T20:04:08.534241Z", "completed_at": "2026-01-04T20:04:08.619635Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11472225189208984, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.dbt_flight_transform.test_delay_category_consistency", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"analytics\".\"main\".\"int_flights_kpis\"\nwhere not (\n    (dep_delay_min is null and delay_category = 'unknown') or\n    (dep_delay_min > 30 and delay_category = 'high_delay') or\n    (dep_delay_min > 15 and dep_delay_min <= 30 and delay_category = 'medium_delay') or\n    (dep_delay_min <= -15 and delay_category = 'early') or\n    (dep_delay_min > -15 and dep_delay_min <= 15 and delay_category = 'ontime')\n)", "relation_name": "\"analytics\".\"main_metadata\".\"test_delay_category_consistency\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-04T20:04:08.637090Z", "completed_at": "2026-01-04T20:04:08.643734Z"}, {"name": "execute", "started_at": "2026-01-04T20:04:08.644220Z", "completed_at": "2026-01-04T20:04:08.696190Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07100105285644531, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbt_flight_transform.int_flights", "compiled": true, "compiled_code": "with int_flights_kpis as (\n    select * from \"analytics\".\"main\".\"int_flights_kpis\"\n)\n\nselect\n    md5(cast(coalesce(cast(flight_iata_full as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(flight_date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as flight_key,\n    flight_date,\n    dep_iata,\n    arr_iata,\n    airline_iata,\n    delay_category,\n    dep_delay_min,\n    avg(avg_delay) over (\n        partition by dep_iata, arr_iata\n        order by flight_date\n        rows between 6 preceding and current row\n    ) as avg_delay_7d\nfrom int_flights_kpis\nqualify row_number() over (\n    partition by flight_iata_full, flight_date\n    order by ingestion_date desc\n) = 1\n", "relation_name": "\"analytics\".\"main\".\"int_flights\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-04T20:04:08.711125Z", "completed_at": "2026-01-04T20:04:08.714153Z"}, {"name": "execute", "started_at": "2026-01-04T20:04:08.714570Z", "completed_at": "2026-01-04T20:04:08.819293Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12561368942260742, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbt_flight_transform.fct_flights", "compiled": true, "compiled_code": "\n\nwith int_flights as (\n    select * from \"analytics\".\"main\".\"int_flights\"\n)\n\nselect * from int_flights", "relation_name": "\"analytics\".\"main\".\"fct_flights\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-04T20:04:08.840219Z", "completed_at": "2026-01-04T20:04:08.843450Z"}, {"name": "execute", "started_at": "2026-01-04T20:04:08.843910Z", "completed_at": "2026-01-04T20:04:08.889674Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06134462356567383, "adapter_response": {"_message": "OK"}, "message": null, "failures": 0, "unique_id": "test.dbt_flight_transform.test_fact_flights_silver_unique_flights", "compiled": true, "compiled_code": "\n\nselect\n    flight_key\nfrom \"analytics\".\"main\".\"fct_flights\"\ngroup by 1\nhaving count(*) > 1", "relation_name": "\"analytics\".\"main_metadata\".\"test_fact_flights_silver_unique_flights\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-04T20:04:08.904040Z", "completed_at": "2026-01-04T20:04:08.907163Z"}, {"name": "execute", "started_at": "2026-01-04T20:04:08.907692Z", "completed_at": "2026-01-04T20:04:08.974617Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08779358863830566, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dbt_flight_transform.fct_route_daily", "compiled": true, "compiled_code": "\n\nwith fct_flights as (\n    select * from \"analytics\".\"main\".\"fct_flights\"\n),\n\nbase as (\n    select\n        flight_date,\n        dep_iata,\n        arr_iata,\n        airline_iata,\n        dep_delay_min,\n        delay_category\n    from fct_flights\n),\n\nagg as (\n    select\n        flight_date,\n        dep_iata,\n        arr_iata,\n        dep_iata || '-' || arr_iata as route,\n        airline_iata,\n        count(*) as total_flights,\n        avg(dep_delay_min) as avg_dep_delay_min,\n        sum(case when delay_category in ('medium_delay','high_delay') then 1 else 0 end) * 100.0 / count(*) as delayed_pct\n    from base\n    group by 1,2,3,4,5\n)\n\nselect\n    flight_date,\n    route,\n    dep_iata,\n    arr_iata,\n    airline_iata,\n    total_flights,\n    round(avg_dep_delay_min, 2) as avg_dep_delay_min,\n    round(delayed_pct, 2) as delayed_pct\nfrom agg", "relation_name": "\"analytics\".\"main\".\"fct_route_daily\""}], "elapsed_time": 1.1484994888305664, "args": {"version_check": true, "macro_debugging": false, "source_freshness_run_project_hooks": false, "invocation_command": "dbt build --profiles-dir . --full-refresh", "partial_parse": true, "which": "build", "static_parser": true, "enable_legacy_logger": false, "defer": false, "log_format": "default", "resource_types": [], "log_path": "/home/luis/personal-projects/data-flight-pipeline/dbt_transform/logs", "use_colors_file": true, "empty": false, "partial_parse_file_diff": true, "quiet": false, "log_file_max_bytes": 10485760, "vars": {}, "require_resource_names_without_spaces": false, "cache_selected_only": false, "exclude_resource_types": [], "profiles_dir": ".", "log_format_file": "debug", "include_saved_query": false, "warn_error_options": {"include": [], "exclude": []}, "log_level": "info", "require_explicit_package_overrides_for_builtin_materializations": true, "populate_cache": true, "favor_state": false, "full_refresh": true, "project_dir": "/home/luis/personal-projects/data-flight-pipeline/dbt_transform", "show": false, "print": true, "export_saved_queries": false, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "use_colors": true, "write_json": true, "strict_mode": false, "printer_width": 80, "exclude": [], "show_resource_report": false, "log_level_file": "debug", "select": [], "introspect": true}}